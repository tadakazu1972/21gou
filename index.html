<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0, user-scalable=no" />
<link rel="stylesheet" href="style.css">
<link rel="stylesheet" href="style2.css">
<!--Google繝槭ャ繝礼函謌�-->
<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA5ZVvKxwqjahjdQuyKVodbU4O58Mcg0ec&region=JP&language=ja"></script>
<script type="text/javascript">
//繝槭ャ繝励が繝悶ず繧ｧ繧ｯ繝郁ｨｭ螳�
var mapObj;
//蛹ｺ蠖ｹ謇�繧堤ｷｯ蠎ｦ繝ｻ霆ｽ蠎ｦ縺ｮ蛻晄悄蛟､縺ｫ險ｭ螳�
var kuname="螟ｧ髦ｪ蟶�";
var kuyakusyo=kuname+"蠖ｹ謇�";
var posX=34.694062;
var posY=135.502154;
//蟾ｦ縺ｮ蝨偵Μ繧ｹ繝医ｒ繧ｯ繝ｪ繝�繧ｯ縺励◆髫帙↓縲∝慍蝗ｳ荳翫↓謖�縺礼､ｺ縺吶�槭�ｼ繧ｫ繝ｼ繧偵げ繝ｭ繝ｼ繝舌Ν螟画焚縺ｧ險ｭ螳�
var marker2; //marker縺ｯ蝨偵�ｮ繧｢繧､繧ｳ繝ｳ縺ｫ菴ｿ逕ｨ縺励※縺�繧九◆繧√�√≠縺医※2縺ｫ縺励※縺�繧�
var marker2posy=posY;
var marker2posx=posX;
//繝槭ャ繝嶺ｽ懈��
google.maps.event.addDomListener(window, 'load', function(){
	//蛻晄悄險ｭ螳�
	var map = document.getElementById("map_canvas");
	var options = {
		zoom: 15,
		center: new google.maps.LatLng(posY, posX),
		mapTypeControl: false,
		mapTypeId: google.maps.MapTypeId.ROADMAP
	};
	mapObj = new google.maps.Map(map, options);
	//蛹ｺ蠖ｹ謇�繧剃ｸｭ蠢�縺ｫ險ｭ螳�
	var pos = new google.maps.LatLng(posY, posX);
	var infowindow = new google.maps.InfoWindow({ map: mapObj, position: pos, content: kuyakusyo});
	mapObj.setCenter(pos);
	//菫晁ご謇�CSV繝輔ぃ繧､繝ｫ隱ｭ縺ｿ霎ｼ縺ｿ
	var xhr = new XMLHttpRequest();
	xhr.onload = function(){
		var tempArray = xhr.responseText.split("\n");
		//
		csvArray = new Array();
		for(var i=0;i<tempArray.length;i++){
			csvArray[i] = tempArray[i].split(",");
			var data = csvArray[i];
			//繝槭�ｼ繧ｫ繝ｼ菴懈�舌��逕ｻ蜒上ヵ繧｡繧､繝ｫ繧定ｪｭ縺ｿ霎ｼ縺ｿ
			var image = 'icon32x320.png'
			var marker = new google.maps.Marker({
				position: new google.maps.LatLng( parseFloat(data[0]), parseFloat(data[1]) ),
				map: mapObj,
				icon: image,
			});
			//csv繝輔ぃ繧､繝ｫ
			//attachMessage(marker, data[2], data[3]);
		}
	};
	xhr.open("get", "exif_master.csv", true);
	xhr.send(null);

	//zoom_change繧､繝吶Φ繝亥叙蠕�
	google.maps.event.addListener(mapObj, 'zoom_changed', function(){
		var offsety; //繝槭�ｼ繧ｫ繝ｼ邨悟ｺｦ隱ｿ謨ｴ
		var zoom = mapObj.getZoom();
		if (zoom<16) { offsety=0.001;   }
		if (zoom==16){ offsety=0.0005;  }
		if (zoom==17){ offsety=0.00025; }
		if (zoom==18){ offsety=0.00015; }
		if (zoom==19){ offsety=0.00008; }
		if (zoom==20){ offsety=0.00004; }
		if (zoom>20) { offsety=0.00002; }
		var pos = new google.maps.LatLng(marker2posy+offsety, marker2posx);
		if (marker2==null){
			marker2 = new google.maps.Marker({ position: pos, map:mapObj });
		} else {
			marker2.setPosition(pos);
		}
	});
});

//隱ｭ縺ｿ霎ｼ繧薙□csv縺九ｉinfowindow縺ｨ蟾ｦ蛛ｴ縺ｫ陦ｨ遉ｺ縺吶ｋ譁ｽ險ｭHTML逕滓��
function attachMessage(getmarker, time, picture) {
	//Infowindow逕滓��
	var path;
	//蜀咏悄縺後↑縺�蝣ｴ蜷医�ｯ縲∽ｽ輔ｂ陦ｨ遉ｺ縺励↑縺�縲よ怙蠕後�ｮ繝�繝ｼ繧ｿ縺ｪ縺ｮ縺ｧ縲仝indows縺ｧcsv菴懈�舌＠縺溷�ｴ蜷医�ｯ謾ｹ陦後さ繝ｼ繝峨′谿九▲縺ｦ縺�繧九→蛻､譁ｭ縺輔ｌ縺ｦ縺薙％縺悟ｮ溯｡後＆繧後↑縺�縺ｮ縺ｧLF縺ｫ螟画峩縺吶ｋ縺薙→
	if (picture=="") {
		path="";
	} else {
		path='<img src=pictures/'+picture+'></br>';
	}
	var infowin = new google.maps.InfoWindow({ content:"謦ｮ蠖ｱ譌･譎ゑｼ�"+time+"</br>"+"蜀咏悄繝�繝ｼ繧ｿ"+path+"</br>"});

	//繝槭え繧ｹ繧ｪ繝ｼ繝舌�ｼ
	google.maps.event.addListener(getmarker, 'mouseover', function() {
		infowin.open(getmarker.getMap(), getmarker);
	});
	//繝槭え繧ｹ繧｢繧ｦ繝�
	google.maps.event.addListener(getmarker, 'mouseout', function(){
		infowin.close();
	});
	//繧ｯ繝ｪ繝�繧ｯ縺ｧ繝ｪ繝ｳ繧ｯ蜈医∈驕ｷ遘ｻ
	/*繧ｹ繝槭�帙〒繧ｿ繝�繝√☆繧九→縺吶＄縺ｫ譁ｽ險ｭHP縺ｸ繧ｸ繝｣繝ｳ繝励＠縺ｦ縺励∪縺�縺溘ａ縲∫ｵ仙ｱ�縲∫┌蜉ｹ蛹悶＠縺ｦ縺�繧�
	google.maps.event.addListener(getmarker, 'click', function(){
		window.open(url);
	});
	*/
	//繝�繝悶Ν繧ｯ繝ｪ繝�繧ｯ縺ｧ繝ｪ繝ｳ繧ｯ蜈医∈驕ｷ遘ｻ
	google.maps.event.addListener(getmarker, 'dblclick', function(){
		window.open(url);
	});
}
</script>
</head>
<body>
	<div id="map_canvas"></div>
</body>
</html>
